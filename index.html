<!DOCTYPE html>
<html>
<head>
    <title>Live Drowsy Alert Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; text-align: center; background: #121212; color: white; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: auto; background: #1e1e1e; padding: 20px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h1 { color: #f1f1f1; margin-bottom: 10px; }
        
        /* Links Section */
        .cloud-links { margin: 20px 0; padding: 15px; background: #252525; border-radius: 10px; display: flex; justify-content: center; gap: 20px; }
        .cloud-links a { text-decoration: none; font-weight: bold; padding: 10px 15px; border-radius: 5px; transition: 0.3s; }
        .btn-firebase { border: 2px solid #ffa000; color: #ffa000; }
        .btn-firebase:hover { background: #ffa000; color: #000; }
        .btn-cloudinary { border: 2px solid #0078ff; color: #0078ff; }
        .btn-cloudinary:hover { background: #0078ff; color: #fff; }

        /* Status Badge */
        .badge { padding: 15px 40px; border-radius: 50px; font-weight: bold; font-size: 1.8rem; display: inline-block; margin: 20px 0; transition: 0.5s; }
        .SAFE { background: #2ecc71; color: #fff; }
        .DANGER { background: #e74c3c; color: #fff; box-shadow: 0 0 20px #ff0000; animation: pulse 1.5s infinite; }
        
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        
        img { width: 100%; max-width: 500px; border: 5px solid #333; border-radius: 10px; margin-top: 20px; }
        .info { color: #888; font-size: 0.9rem; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>Driver Monitoring Dashboard</h1>
    
    <div class="cloud-links">
        <a href="https://console.firebase.google.com/u/0/project/drowsydriver-eff03/database/drowsydriver-eff03-default-rtdb/data" target="_blank" class="btn-firebase">
            V1: Firebase Console
        </a>
        <a href="https://console.cloudinary.com/console/media_library/folders/search?q=drowsy_alerts" target="_blank" class="btn-cloudinary">
            V2: Cloudinary Gallery
        </a>
    </div>

    <div id="status" class="badge SAFE">CONNECTING...</div>
    
    <p class="info">Last Update Received: <span id="ts" style="color: #fff;">--</span></p>

    <div>
        <h3>Latest Alert Snapshot</h3>
        <img id="alertImg" src="https://via.placeholder.com/400x300?text=No+Danger+Detected" alt="Driver Photo">
    </div>
</div>

<script>
    // Configuration
    const firebaseConfig = { databaseURL: "https://drowsydriver-eff03-default-rtdb.firebaseio.com/" };
    firebase.initializeApp(firebaseConfig);
    const dbRef = firebase.database().ref('driver_status');

    // Real-time listener
    dbRef.on('value', (snapshot) => {
        const data = snapshot.val();
        if (data) {
            const statusEl = document.getElementById('status');
            const tsEl = document.getElementById('ts');
            const imgEl = document.getElementById('alertImg');

            // Update UI
            statusEl.innerText = data.status || "UNKNOWN";
            statusEl.className = 'badge ' + (data.status === "DANGER" ? "DANGER" : "SAFE");
            tsEl.innerText = data.timestamp || "N/A";

            if (data.last_alert_image) {
                imgEl.src = data.last_alert_image;
            }
        }
    });
</script>

</body>
</html>
